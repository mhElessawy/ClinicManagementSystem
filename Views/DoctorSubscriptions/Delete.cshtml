@model ClinicManagementSystem.Models.DoctorSubscription

@{
    ViewData["Title"] = "Delete Subscription";
}

<div class="row">
    <div class="col-md-8 offset-md-2">
        <div class="card border-danger">
            <div class="card-header bg-danger text-white">
                <h4 class="mb-0">
                    <i class="fas fa-trash-alt"></i> Delete Subscription
                </h4>
            </div>
            <div class="card-body">
                <div class="alert alert-warning">
                    <i class="fas fa-exclamation-triangle"></i>
                    <strong>Warning!</strong> Are you sure you want to delete this subscription?
                </div>

                <h5>Subscription Details:</h5>
                <dl class="row">
                    <dt class="col-sm-4">Doctor:</dt>
                    <dd class="col-sm-8"><strong>@Model.Doctor.DoctorName</strong></dd>

                    <dt class="col-sm-4">Subscription Type:</dt>
                    <dd class="col-sm-8">
                        @if (!string.IsNullOrEmpty(Model.SubscriptionType))
                        {
                            <span class="badge bg-info">@Model.SubscriptionType</span>
                        }
                        else
                        {
                            <span class="text-muted">-</span>
                        }
                    </dd>

                    <dt class="col-sm-4">Start Date:</dt>
                    <dd class="col-sm-8">@Model.StartDate.ToString("yyyy-MM-dd")</dd>

                    <dt class="col-sm-4">End Date:</dt>
                    <dd class="col-sm-8">@Model.EndDate.ToString("yyyy-MM-dd")</dd>

                    <dt class="col-sm-4">Duration:</dt>
                    <dd class="col-sm-8">
                        @{
                            var duration = (Model.EndDate - Model.StartDate).Days;
                            var months = duration / 30;
                        }
                        @if (months > 0)
                        {
                            <span>@months month(s) (@duration days)</span>
                        }
                        else
                        {
                            <span>@duration day(s)</span>
                        }
                    </dd>

                    <dt class="col-sm-4">Status:</dt>
                    <dd class="col-sm-8">
                        @{
                            var today = DateTime.Today;
                            var isCurrentlyValid = Model.IsActive && Model.StartDate <= today && Model.EndDate >= today;
                        }
                        @if (isCurrentlyValid)
                        {
                            <span class="badge bg-success">
                                <i class="fas fa-check-circle"></i> Active
                            </span>
                        }
                        else if (Model.IsExpired)
                        {
                            <span class="badge bg-danger">
                                <i class="fas fa-times-circle"></i> Expired
                            </span>
                        }
                        else if (!Model.IsActive)
                        {
                            <span class="badge bg-secondary">
                                <i class="fas fa-ban"></i> Inactive
                            </span>
                        }
                        else
                        {
                            <span class="badge bg-warning">
                                <i class="fas fa-clock"></i> Pending
                            </span>
                        }
                    </dd>

                    @if (!string.IsNullOrEmpty(Model.Notes))
                    {
                        <dt class="col-sm-4">Notes:</dt>
                        <dd class="col-sm-8">@Model.Notes</dd>
                    }

                    <dt class="col-sm-4">Created Date:</dt>
                    <dd class="col-sm-8">@Model.CreatedDate.ToString("yyyy-MM-dd HH:mm")</dd>

                    @if (Model.ModifiedDate.HasValue)
                    {
                        <dt class="col-sm-4">Last Modified:</dt>
                        <dd class="col-sm-8">@Model.ModifiedDate.Value.ToString("yyyy-MM-dd HH:mm")</dd>
                    }
                </dl>

                <form asp-action="Delete" method="post">
                    @Html.AntiForgeryToken()
                    <input type="hidden" asp-for="Id" />
                    <div class="mt-4">
                        <button type="submit" class="btn btn-danger">
                            <i class="fas fa-trash"></i> Yes, Delete This Subscription
                        </button>
                        <a asp-action="Index" asp-route-doctorId="@Model.DoctorId" class="btn btn-secondary">
                            <i class="fas fa-times"></i> Cancel
                        </a>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
